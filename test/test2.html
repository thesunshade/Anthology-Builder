<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Table of Contents</title>
    <style>
      /* Add some basic styling for better presentation */
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }

      ul {
        list-style-type: none;
      }

      a {
        text-decoration: none;
        color: #333;
      }

      a:hover {
        color: #007bff;
      }
    </style>
  </head>
  <body>
    <!-- Example DOM structure -->
    <h1>First heading</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in risus sit amet nunc elementum dignissim. Sed id lacus sed dolor facilisis mattis. Etiam feugiat ut lacus eget gravida. Aliquam erat volutpat. Cras at velit eu diam luctus commodo. Mauris ut odio in purus consectetur ultrices. Nullam a mauris feugiat, faucibus purus in, condimentum dui. Cras nulla mi, ultrices eu faucibus quis, laoreet sed magna. Suspendisse vitae mi lacus. Morbi vel massa purus. Integer elementum arcu vel faucibus dictum. Nam
      id porttitor neque. Nam feugiat rhoncus tortor non semper. Duis sed finibus tellus. Aliquam sed ante vel lectus dictum venenatis sit amet quis tellus. In fermentum vitae massa at euismod. Proin eleifend arcu a risus venenatis, nec porta arcu molestie. Mauris iaculis non erat in gravida. In nulla ante, iaculis at faucibus ac, egestas in quam. Maecenas facilisis sem quis leo condimentum, rutrum luctus est efficitur. Nam pretium, magna sit amet semper finibus, eros ipsum vehicula ligula, vitae imperdiet neque
      nulla ac mi. Vivamus mollis tellus at nisl malesuada elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus pellentesque libero ut nulla feugiat, in ultrices ipsum luctus. Nulla ut lectus tincidunt, varius lacus eu, efficitur sapien. Suspendisse faucibus justo sed tellus semper luctus.
    </p>
    <h2>First sub</h2>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in risus sit amet nunc elementum dignissim. Sed id lacus sed dolor facilisis mattis. Etiam feugiat ut lacus eget gravida. Aliquam erat volutpat. Cras at velit eu diam luctus commodo. Mauris ut odio in purus consectetur ultrices. Nullam a mauris feugiat, faucibus purus in, condimentum dui. Cras nulla mi, ultrices eu faucibus quis, laoreet sed magna. Suspendisse vitae mi lacus. Morbi vel massa purus. Integer elementum arcu vel faucibus dictum. Nam
      id porttitor neque. Nam feugiat rhoncus tortor non semper. Duis sed finibus tellus. Aliquam sed ante vel lectus dictum venenatis sit amet quis tellus. In fermentum vitae massa at euismod. Proin eleifend arcu a risus venenatis, nec porta arcu molestie. Mauris iaculis non erat in gravida. In nulla ante, iaculis at faucibus ac, egestas in quam. Maecenas facilisis sem quis leo condimentum, rutrum luctus est efficitur. Nam pretium, magna sit amet semper finibus, eros ipsum vehicula ligula, vitae imperdiet neque
      nulla ac mi. Vivamus mollis tellus at nisl malesuada elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus pellentesque libero ut nulla feugiat, in ultrices ipsum luctus. Nulla ut lectus tincidunt, varius lacus eu, efficitur sapien. Suspendisse faucibus justo sed tellus semper luctus.
    </p>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in risus sit amet nunc elementum dignissim. Sed id lacus sed dolor facilisis mattis. Etiam feugiat ut lacus eget gravida. Aliquam erat volutpat. Cras at velit eu diam luctus commodo. Mauris ut odio in purus consectetur ultrices. Nullam a mauris feugiat, faucibus purus in, condimentum dui. Cras nulla mi, ultrices eu faucibus quis, laoreet sed magna. Suspendisse vitae mi lacus. Morbi vel massa purus. Integer elementum arcu vel faucibus dictum. Nam
      id porttitor neque. Nam feugiat rhoncus tortor non semper. Duis sed finibus tellus. Aliquam sed ante vel lectus dictum venenatis sit amet quis tellus. In fermentum vitae massa at euismod. Proin eleifend arcu a risus venenatis, nec porta arcu molestie. Mauris iaculis non erat in gravida. In nulla ante, iaculis at faucibus ac, egestas in quam. Maecenas facilisis sem quis leo condimentum, rutrum luctus est efficitur. Nam pretium, magna sit amet semper finibus, eros ipsum vehicula ligula, vitae imperdiet neque
      nulla ac mi. Vivamus mollis tellus at nisl malesuada elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus pellentesque libero ut nulla feugiat, in ultrices ipsum luctus. Nulla ut lectus tincidunt, varius lacus eu, efficitur sapien. Suspendisse faucibus justo sed tellus semper luctus.
    </p>
    <h3>First sub sub</h3>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in risus sit amet nunc elementum dignissim. Sed id lacus sed dolor facilisis mattis. Etiam feugiat ut lacus eget gravida. Aliquam erat volutpat. Cras at velit eu diam luctus commodo. Mauris ut odio in purus consectetur ultrices. Nullam a mauris feugiat, faucibus purus in, condimentum dui. Cras nulla mi, ultrices eu faucibus quis, laoreet sed magna. Suspendisse vitae mi lacus. Morbi vel massa purus. Integer elementum arcu vel faucibus dictum. Nam
      id porttitor neque. Nam feugiat rhoncus tortor non semper. Duis sed finibus tellus. Aliquam sed ante vel lectus dictum venenatis sit amet quis tellus. In fermentum vitae massa at euismod. Proin eleifend arcu a risus venenatis, nec porta arcu molestie. Mauris iaculis non erat in gravida. In nulla ante, iaculis at faucibus ac, egestas in quam. Maecenas facilisis sem quis leo condimentum, rutrum luctus est efficitur. Nam pretium, magna sit amet semper finibus, eros ipsum vehicula ligula, vitae imperdiet neque
      nulla ac mi. Vivamus mollis tellus at nisl malesuada elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus pellentesque libero ut nulla feugiat, in ultrices ipsum luctus. Nulla ut lectus tincidunt, varius lacus eu, efficitur sapien. Suspendisse faucibus justo sed tellus semper luctus.
    </p>
    <h1>Second head</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in risus sit amet nunc elementum dignissim. Sed id lacus sed dolor facilisis mattis. Etiam feugiat ut lacus eget gravida. Aliquam erat volutpat. Cras at velit eu diam luctus commodo. Mauris ut odio in purus consectetur ultrices. Nullam a mauris feugiat, faucibus purus in, condimentum dui. Cras nulla mi, ultrices eu faucibus quis, laoreet sed magna. Suspendisse vitae mi lacus. Morbi vel massa purus. Integer elementum arcu vel faucibus dictum. Nam
      id porttitor neque. Nam feugiat rhoncus tortor non semper. Duis sed finibus tellus. Aliquam sed ante vel lectus dictum venenatis sit amet quis tellus. In fermentum vitae massa at euismod. Proin eleifend arcu a risus venenatis, nec porta arcu molestie. Mauris iaculis non erat in gravida. In nulla ante, iaculis at faucibus ac, egestas in quam. Maecenas facilisis sem quis leo condimentum, rutrum luctus est efficitur. Nam pretium, magna sit amet semper finibus, eros ipsum vehicula ligula, vitae imperdiet neque
      nulla ac mi. Vivamus mollis tellus at nisl malesuada elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus pellentesque libero ut nulla feugiat, in ultrices ipsum luctus. Nulla ut lectus tincidunt, varius lacus eu, efficitur sapien. Suspendisse faucibus justo sed tellus semper luctus.
    </p>
    <h2>Second sub</h2>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in risus sit amet nunc elementum dignissim. Sed id lacus sed dolor facilisis mattis. Etiam feugiat ut lacus eget gravida. Aliquam erat volutpat. Cras at velit eu diam luctus commodo. Mauris ut odio in purus consectetur ultrices. Nullam a mauris feugiat, faucibus purus in, condimentum dui. Cras nulla mi, ultrices eu faucibus quis, laoreet sed magna. Suspendisse vitae mi lacus. Morbi vel massa purus. Integer elementum arcu vel faucibus dictum. Nam
      id porttitor neque. Nam feugiat rhoncus tortor non semper. Duis sed finibus tellus. Aliquam sed ante vel lectus dictum venenatis sit amet quis tellus. In fermentum vitae massa at euismod. Proin eleifend arcu a risus venenatis, nec porta arcu molestie. Mauris iaculis non erat in gravida. In nulla ante, iaculis at faucibus ac, egestas in quam. Maecenas facilisis sem quis leo condimentum, rutrum luctus est efficitur. Nam pretium, magna sit amet semper finibus, eros ipsum vehicula ligula, vitae imperdiet neque
      nulla ac mi. Vivamus mollis tellus at nisl malesuada elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus pellentesque libero ut nulla feugiat, in ultrices ipsum luctus. Nulla ut lectus tincidunt, varius lacus eu, efficitur sapien. Suspendisse faucibus justo sed tellus semper luctus.
    </p>
    <h3>Second sub sub</h3>

    <script>
      // Function to generate Table of Contents
      function generateTableOfContents() {
        const headings = document.querySelectorAll("h1, h2, h3");
        const firstElement = document.body.firstElementChild; // Get the first element on the page

        if (headings.length === 0 || !firstElement) {
          console.error("No headings or first element found.");
          return;
        }

        const tocList = document.createElement("ul");
        let currentList = tocList;
        let lastLevel = 1;

        headings.forEach((heading, index) => {
          // Add IDs to headings if they don't have one
          if (!heading.id) {
            heading.id = "heading" + (index + 1);
          }

          const level = parseInt(heading.tagName.charAt(1));

          if (level > lastLevel) {
            // Create a nested list for subheadings
            const sublist = document.createElement("ul");
            currentList.lastElementChild.appendChild(sublist);
            currentList = sublist;
          } else if (level < lastLevel) {
            // Move back to the parent list for higher-level headings
            for (let i = level; i < lastLevel; i++) {
              currentList = currentList.parentElement.parentElement;
            }
          }

          // Create list item and anchor for each heading
          const listItem = document.createElement("li");
          const anchor = document.createElement("a");
          anchor.href = "#" + heading.id;
          anchor.textContent = heading.textContent;
          listItem.appendChild(anchor);
          currentList.appendChild(listItem);

          // Update lastLevel for the next iteration
          lastLevel = level;
        });

        // Insert the generated Table of Contents as the first element on the page
        firstElement.insertAdjacentElement("beforebegin", tocList);
      }

      // Call the function when the DOM is ready
      document.addEventListener("DOMContentLoaded", generateTableOfContents);
    </script>

    <!-- Continue with the rest of the content -->
  </body>
</html>
